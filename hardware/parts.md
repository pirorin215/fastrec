# 部品表（BOM）

## 主要部品

| 部品 | 型番/仕様 | 数量 | 価格 | 購入先 |
|------|----------|------|------|--------|
| マイコンボード | XIAO ESP32S3 | 1 | 約1500円 | AliExpress |
| 外部アンテナ | U.FL/IPEXコネクタ付き | 1 | 付属 | XIAO ESP32S3に同梱 |
| I2Sマイク | SPH0645LM4H | 1 | 約500円 | AliExpress |
| 振動モーター | DC5V モジュール | 1 | 約500円 | Amazon |
| リチウムイオン電池 | 401730 150mAh | 1 | 約500円 | Amazon（2個約1000円） |
| タクトスイッチ | 6x6mm | 2 | 数十円 | 秋月電子、Amazon等 |
| 抵抗 | 10kΩ | 2 | 数十円 | 電池電圧監視用（分圧回路） |

**合計費用**: 約3000円（OLEDなし）

## オプション部品

| 部品 | 型番/仕様 | 価格 | 用途 |
|------|----------|------|------|
| OLEDディスプレイ | EGBO 0.42インチ 72x40 SSD1315 | 約300円 | デバッグ用（I2C接続） |
| スライドスイッチ | - | 数十円 | 電源オンオフ用 |
| LED | 赤/緑/黄 | 数十円 | ステータス表示 |

※ 150mAhの電池で約5日間駆動可能です。小ささを重視した構成です。

## 外部アンテナの接続

XIAO ESP32S3に付属している外部アンテナを接続してください。

- BLE通信（2.4GHz）に使用します
- 基板のU.FLコネクタ（IPEXコネクタ）にアンテナを接続します
- アンテナ未接続の場合、通信距離や安定性が低下します

## 接続ピン割り当て

### I2Sマイク（SPH0645LM4H）

| 信号線 | XIAO ESP32S3 ピン | 備考 |
|--------|----------|------|
| SCK | GPIO7 | クロック（I2S_BCLK） |
| WS | GPIO9 | ワードセレクト（I2S_LRCK） |
| SD | GPIO8 | シリアルデータ（I2S_DOUT） |
| VDD | 3.3V | 電源 |
| GND | GND | グラウンド |
| SEL | GND | チャンネル選択（GNDで左チャンネル） |

### 振動モーター（MOSドライバモジュール使用）

| 信号線 | XIAO ESP32S3 ピン | 備考 |
|--------|----------|------|
| 信号 | GPIO3 | PWM制御 |
| VCC | VBAT+ | リポバッテリー+端子直結 |
| GND | GND | グラウンド |

※ MOSドライバモジュールを使用することで、リーク電流を抑え省電力化しています。

### 電池電圧監視

| 信号線 | XIAO ESP32S3 ピン | 備考 |
|--------|----------|------|
| 分圧点 | GPIO5 | ADC入力（10kΩ抵抗2つで分圧） |

**配線**:
- リポバッテリー+ → 10kΩ抵抗 → GPIO5（分圧点） → 10kΩ抵抗 → GND
- 抵抗2本で分圧し、電圧を半分にしてESP32のADC（最大3.3V）で測定
- 低電圧通知機能：設定した電圧を下回るとAndroidアプリに通知

### ボタン

| ボタン | XIAO ESP32S3 ピン | 備考 |
|--------|----------|------|
| REC | GPIO1 | 録音/停止 |

### OLEDディスプレイ（オプション）

| 信号線 | XIAO ESP32S3 ピン | 備考 |
|--------|----------|------|
| SDA | GPIO43 | I2Cデータ |
| SCL | GPIO44 | I2Cクロック |
| VCC | 3.3V | 電源 |
| GND | GND | グラウンド |

※ GPIO割り当てはファームウェア側で変更可能です。

## 接続例

### 基本配線

```
ESP32-S3        External Antenna
-------         -----------------
U.FL   ────────→ アンテナ接続

ESP32-S3        I2S Mic
-------         -------
GPIO7  ────────→ SCK
GPIO9  ────────→ WS
GPIO8  ────────→ SD
3.3V   ────────→ VDD
GND    ────────→ GND
GND    ────────→ SEL

ESP32-S3        Vibration Motor
-------         ----------------
GPIO3  ────────→ Signal
VBAT+  ────────→ VCC

ESP32-S3        Button
-------         ------
GPIO1  ────────→ REC

ESP32-S3        Battery Monitor
-------         ----------------
GPIO5  ────────→ 分圧点（10kΩ x2で分圧）
```

#### オプション：OLED接続

```
ESP32-S3        OLED (オプション)
-------         ------
GPIO43 ────────→ SDA
GPIO44 ────────→ SCL
```

**注記**:
- I2SマイクのVDDは3.3V、GNDはGNDに接続、SELはGNDに接続（左チャンネル選択）
- 振動モーターのGNDはGNDに接続
- ボタンのもう片方は3.3Vに接続
- 電池監視用の分圧回路は、10kΩ抵抗2本を直列に接続

## 参考回路図

詳細な回路図は `schematic.pdf` を参照してください（準備中）。

## 購入先リンク

- **XIAO ESP32S3**: [AliExpress](https://www.aliexpress.com/) で "XIAO ESP32S3" を検索
- **SPH0645LM4H**: [AliExpress](https://www.aliexpress.com/) で "SPH0645LM4H" を検索
- **振動モーターモジュール**: Amazon で "振動モーター モジュール DC5V" を検索
- **401730電池**: Amazon で "401730 リチウムイオン 電池" を検索
- **OLED**: [AliExpress](https://www.aliexpress.com/) で "0.42 inch OLED 72x40" を検索

## その他の部品

- ケースは3Dプリント（STLデータは準備中）。
